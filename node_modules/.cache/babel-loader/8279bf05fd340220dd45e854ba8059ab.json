{"ast":null,"code":"\"use strict\";\n\nvar __assign = this && this.__assign || function () {\n  __assign = Object.assign || function (t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n      s = arguments[i];\n\n      for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\n    }\n\n    return t;\n  };\n\n  return __assign.apply(this, arguments);\n};\n\nvar __createBinding = this && this.__createBinding || (Object.create ? function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  Object.defineProperty(o, k2, {\n    enumerable: true,\n    get: function () {\n      return m[k];\n    }\n  });\n} : function (o, m, k, k2) {\n  if (k2 === undefined) k2 = k;\n  o[k2] = m[k];\n});\n\nvar __setModuleDefault = this && this.__setModuleDefault || (Object.create ? function (o, v) {\n  Object.defineProperty(o, \"default\", {\n    enumerable: true,\n    value: v\n  });\n} : function (o, v) {\n  o[\"default\"] = v;\n});\n\nvar __importStar = this && this.__importStar || function (mod) {\n  if (mod && mod.__esModule) return mod;\n  var result = {};\n  if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n\n  __setModuleDefault(result, mod);\n\n  return result;\n};\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar react_1 = __importStar(require(\"react\"));\n\nvar immutable_1 = __importDefault(require(\"immutable\"));\n\nvar classnames_1 = __importDefault(require(\"classnames\"));\n\nvar styles_1 = require(\"@mui/styles\");\n\nvar material_1 = require(\"@mui/material\");\n\nvar draft_js_1 = require(\"draft-js\");\n\nvar Toolbar_1 = __importDefault(require(\"./components/Toolbar\"));\n\nvar Link_1 = __importDefault(require(\"./components/Link\"));\n\nvar Media_1 = __importDefault(require(\"./components/Media\"));\n\nvar Blockquote_1 = __importDefault(require(\"./components/Blockquote\"));\n\nvar CodeBlock_1 = __importDefault(require(\"./components/CodeBlock\"));\n\nvar UrlPopover_1 = __importDefault(require(\"./components/UrlPopover\"));\n\nvar Autocomplete_1 = __importDefault(require(\"./components/Autocomplete\"));\n\nvar utils_1 = require(\"./utils\");\n\nvar styles = function (theme) {\n  var _a, _b, _c, _d, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w, _x, _y, _z, _0, _1, _2, _3, _4;\n\n  return (0, styles_1.createStyles)({\n    root: ((_b = (_a = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _a === void 0 ? void 0 : _a.MUIRichTextEditor) === null || _b === void 0 ? void 0 : _b.root) || {},\n    container: ((_d = (_c = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _c === void 0 ? void 0 : _c.MUIRichTextEditor) === null || _d === void 0 ? void 0 : _d.container) || {\n      margin: theme.spacing(1, 0, 0, 0),\n      position: \"relative\",\n      fontFamily: theme.typography.body1.fontFamily,\n      fontSize: theme.typography.body1.fontSize,\n      '& figure': {\n        margin: 0\n      }\n    },\n    inheritFontSize: ((_g = (_f = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _f === void 0 ? void 0 : _f.MUIRichTextEditor) === null || _g === void 0 ? void 0 : _g.inheritFontSize) || {\n      fontSize: \"inherit\"\n    },\n    editor: ((_j = (_h = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _h === void 0 ? void 0 : _h.MUIRichTextEditor) === null || _j === void 0 ? void 0 : _j.editor) || {},\n    editorContainer: ((_l = (_k = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _k === void 0 ? void 0 : _k.MUIRichTextEditor) === null || _l === void 0 ? void 0 : _l.editorContainer) || {\n      margin: theme.spacing(1, 0, 0, 0),\n      cursor: \"text\",\n      width: \"100%\",\n      padding: theme.spacing(0, 0, 1, 0)\n    },\n    editorReadOnly: ((_o = (_m = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _m === void 0 ? void 0 : _m.MUIRichTextEditor) === null || _o === void 0 ? void 0 : _o.editorReadOnly) || {\n      borderBottom: \"none\"\n    },\n    error: ((_q = (_p = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _p === void 0 ? void 0 : _p.MUIRichTextEditor) === null || _q === void 0 ? void 0 : _q.error) || {\n      borderBottom: \"2px solid red\"\n    },\n    hidePlaceholder: ((_s = (_r = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _r === void 0 ? void 0 : _r.MUIRichTextEditor) === null || _s === void 0 ? void 0 : _s.hidePlaceholder) || {\n      display: \"none\"\n    },\n    placeHolder: ((_u = (_t = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _t === void 0 ? void 0 : _t.MUIRichTextEditor) === null || _u === void 0 ? void 0 : _u.placeHolder) || {\n      color: theme.palette.grey[600],\n      position: \"absolute\",\n      outline: \"none\"\n    },\n    linkPopover: ((_w = (_v = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _v === void 0 ? void 0 : _v.MUIRichTextEditor) === null || _w === void 0 ? void 0 : _w.linkPopover) || {\n      padding: theme.spacing(2, 2, 2, 2)\n    },\n    linkTextField: ((_y = (_x = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _x === void 0 ? void 0 : _x.MUIRichTextEditor) === null || _y === void 0 ? void 0 : _y.linkTextField) || {\n      width: \"100%\"\n    },\n    anchorLink: ((_0 = (_z = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _z === void 0 ? void 0 : _z.MUIRichTextEditor) === null || _0 === void 0 ? void 0 : _0.anchorLink) || {},\n    toolbar: ((_2 = (_1 = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _1 === void 0 ? void 0 : _1.MUIRichTextEditor) === null || _2 === void 0 ? void 0 : _2.toolbar) || {},\n    inlineToolbar: ((_4 = (_3 = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _3 === void 0 ? void 0 : _3.MUIRichTextEditor) === null || _4 === void 0 ? void 0 : _4.inlineToolbar) || {\n      maxWidth: \"180px\",\n      position: \"absolute\",\n      padding: \"5px\",\n      zIndex: 10\n    }\n  });\n};\n\nvar blockRenderMap = immutable_1.default.Map({\n  'blockquote': {\n    element: \"blockquote\",\n    wrapper: react_1.default.createElement(Blockquote_1.default, null)\n  },\n  'code-block': {\n    element: \"pre\",\n    wrapper: react_1.default.createElement(CodeBlock_1.default, null)\n  }\n});\nvar styleRenderMap = {\n  'STRIKETHROUGH': {\n    textDecoration: \"line-through\"\n  },\n  'HIGHLIGHT': {\n    backgroundColor: \"yellow\"\n  }\n};\nvar hasCommandModifier = draft_js_1.KeyBindingUtil.hasCommandModifier;\nvar autocompleteMinSearchCharCount = 2;\nvar lineHeight = 26;\nvar defaultInlineToolbarControls = [\"bold\", \"italic\", \"underline\", \"clear\"];\n\nvar findLinkEntities = function (contentBlock, callback, contentState) {\n  contentBlock.findEntityRanges(function (character) {\n    var entityKey = character.getEntity();\n    return entityKey !== null && contentState.getEntity(entityKey).getType() === 'LINK';\n  }, callback);\n};\n\nvar findDecoWithRegex = function (regex, contentBlock, callback) {\n  var text = contentBlock.getText();\n  var matchArr, start;\n\n  while ((matchArr = regex.exec(text)) !== null) {\n    start = matchArr.index;\n    callback(start, start + matchArr[0].length);\n  }\n};\n\nvar useEditorState = function (props) {\n  var decorators = [{\n    strategy: findLinkEntities,\n    component: Link_1.default\n  }];\n\n  if (props.decorators) {\n    props.decorators.forEach(function (deco) {\n      return decorators.push({\n        strategy: function (contentBlock, callback) {\n          findDecoWithRegex(deco.regex, contentBlock, callback);\n        },\n        component: deco.component\n      });\n    });\n  }\n\n  var decorator = new draft_js_1.CompositeDecorator(decorators);\n  var defaultValue = props.defaultValue || props.value;\n  return defaultValue ? draft_js_1.EditorState.createWithContent((0, draft_js_1.convertFromRaw)(JSON.parse(defaultValue)), decorator) : draft_js_1.EditorState.createEmpty(decorator);\n};\n\nvar MUIRichTextEditor = function (props, ref) {\n  var _a, _b, _c;\n\n  var classes = props.classes,\n      controls = props.controls,\n      customControls = props.customControls;\n\n  var _d = (0, react_1.useState)({}),\n      state = _d[0],\n      setState = _d[1];\n\n  var _f = (0, react_1.useState)(false),\n      focus = _f[0],\n      setFocus = _f[1];\n\n  var _g = (0, react_1.useState)(\"\"),\n      searchTerm = _g[0],\n      setSearchTerm = _g[1];\n\n  var _h = (0, react_1.useState)(0),\n      selectedIndex = _h[0],\n      setSelectedIndex = _h[1];\n\n  var _j = (0, react_1.useState)(function () {\n    return useEditorState(props);\n  }),\n      editorState = _j[0],\n      setEditorState = _j[1];\n\n  var _k = (0, react_1.useState)(\"\"),\n      focusMediaKey = _k[0],\n      setFocusMediaKey = _k[1];\n\n  var editorRef = (0, react_1.useRef)(null);\n  var editorId = props.id || \"mui-rte\";\n  var toolbarPositionRef = (0, react_1.useRef)(undefined);\n  var editorStateRef = (0, react_1.useRef)(editorState);\n  var autocompleteRef = (0, react_1.useRef)(undefined);\n  var autocompleteSelectionStateRef = (0, react_1.useRef)(undefined);\n  var autocompletePositionRef = (0, react_1.useRef)(undefined);\n  var autocompleteLimit = props.autocomplete ? props.autocomplete.suggestLimit || 5 : 5;\n  var isFirstFocus = (0, react_1.useRef)(true);\n  var customBlockMapRef = (0, react_1.useRef)(undefined);\n  var customStyleMapRef = (0, react_1.useRef)(undefined);\n  var isFocusedWithMouse = (0, react_1.useRef)(false);\n  var selectionRef = (0, react_1.useRef)({\n    start: 0,\n    end: 0\n  });\n  /**\n   * Exposed methods\n   */\n\n  (0, react_1.useImperativeHandle)(ref, function () {\n    return {\n      focus: function () {\n        handleFocus();\n      },\n      save: function () {\n        handleSave();\n      },\n      insertAtomicBlock: function (name, data) {\n        handleInsertAtomicBlockSync(name, data);\n      },\n      insertAtomicBlockSync: function (name, data) {\n        handleInsertAtomicBlockSync(name, data);\n      },\n      insertAtomicBlockAsync: function (name, promise, placeholder) {\n        handleInsertAtomicBlockAsync(name, promise, placeholder);\n      }\n    };\n  });\n  (0, react_1.useEffect)(function () {\n    var editorState = useEditorState(props);\n    setEditorState(editorState);\n    toggleMouseUpListener(true);\n    return function () {\n      toggleMouseUpListener();\n    };\n  }, [props.value, props.defaultValue]);\n  (0, react_1.useEffect)(function () {\n    if (props.onChange) {\n      props.onChange(editorState);\n    }\n\n    editorStateRef.current = editorState;\n  }, [editorState]);\n  (0, react_1.useEffect)(function () {\n    toolbarPositionRef.current = state.toolbarPosition;\n  }, [state.toolbarPosition]);\n  (0, react_1.useEffect)(function () {\n    if (searchTerm.length < autocompleteMinSearchCharCount) {\n      setSelectedIndex(0);\n    }\n  }, [searchTerm]);\n\n  var clearSearch = function () {\n    setSearchTerm(\"\");\n    autocompletePositionRef.current = undefined;\n    autocompleteSelectionStateRef.current = undefined;\n  };\n\n  var handleMouseUp = function (event) {\n    var nodeName = event.target.nodeName;\n    clearSearch();\n\n    if (nodeName === \"IMG\" || nodeName === \"VIDEO\") {\n      return;\n    }\n\n    setTimeout(function () {\n      var _a;\n\n      var selection = editorStateRef.current.getSelection();\n\n      if (selection.isCollapsed() || toolbarPositionRef !== undefined && selectionRef.current.start === selection.getStartOffset() && selectionRef.current.end === selection.getEndOffset()) {\n        var selectionInfo = (0, utils_1.getSelectionInfo)(editorStateRef.current);\n\n        if (selectionInfo.entityType === \"IMAGE\") {\n          focusMedia(selectionInfo.block);\n          return;\n        }\n\n        setState(__assign(__assign({}, state), {\n          toolbarPosition: undefined\n        }));\n        return;\n      }\n\n      selectionRef.current = {\n        start: selection.getStartOffset(),\n        end: selection.getEndOffset()\n      };\n      var editor = (_a = editorRef.current) === null || _a === void 0 ? void 0 : _a.editor;\n\n      if (!editor) {\n        return;\n      }\n\n      var _b = (0, utils_1.getEditorBounds)(editor),\n          editorRect = _b.editorRect,\n          selectionRect = _b.selectionRect;\n\n      if (!selectionRect) {\n        return;\n      }\n\n      var position = {\n        top: editor.offsetTop - 48 + (selectionRect.top - editorRect.top),\n        left: editor.offsetLeft + (selectionRect.left - editorRect.left)\n      };\n      setState(__assign(__assign({}, state), {\n        toolbarPosition: position\n      }));\n    }, 1);\n  };\n\n  var findAutocompleteStrategy = function (chars) {\n    if (!props.autocomplete) {\n      return undefined;\n    }\n\n    var acArray = props.autocomplete.strategies.filter(function (ac) {\n      return ac.triggerChar === chars;\n    });\n\n    if (acArray.length) {\n      return acArray[0];\n    }\n\n    return undefined;\n  };\n\n  var updateAutocompletePosition = function () {\n    var _a;\n\n    var editor = (_a = editorRef.current) === null || _a === void 0 ? void 0 : _a.editor;\n\n    if (!editor) {\n      return;\n    }\n\n    var _b = (0, utils_1.getEditorBounds)(editor),\n        editorRect = _b.editorRect,\n        selectionRect = _b.selectionRect;\n\n    var line = (0, utils_1.getLineNumber)(editorState);\n    var top = selectionRect ? selectionRect.top : editorRect.top + lineHeight * line;\n    var left = selectionRect ? selectionRect.left : editorRect.left;\n    var position = {\n      top: editor.offsetTop + (top - editorRect.top) + lineHeight,\n      left: editor.offsetLeft + (left - editorRect.left)\n    };\n\n    if (!autocompleteSelectionStateRef.current) {\n      autocompleteSelectionStateRef.current = editorStateRef.current.getSelection();\n    }\n\n    autocompletePositionRef.current = position;\n  };\n\n  var insertAutocompleteSuggestionAsAtomicBlock = function (name, selection, value) {\n    var block = (0, utils_1.atomicBlockExists)(name, props.customControls);\n\n    if (!block) {\n      return;\n    }\n\n    var contentState = draft_js_1.Modifier.removeRange(editorStateRef.current.getCurrentContent(), selection, \"forward\");\n    var newEditorState = draft_js_1.EditorState.push(editorStateRef.current, contentState, \"remove-range\");\n    var withAtomicBlock = insertAtomicBlock(newEditorState, name.toUpperCase(), {\n      value: value\n    }, {\n      selection: newEditorState.getCurrentContent().getSelectionAfter()\n    });\n    handleChange(withAtomicBlock);\n  };\n\n  var insertAutocompleteSuggestionAsText = function (selection, value) {\n    var currentContentState = editorState.getCurrentContent();\n    var entityKey = currentContentState.createEntity(\"AC_ITEM\", 'IMMUTABLE').getLastCreatedEntityKey();\n    var contentState = draft_js_1.Modifier.replaceText(editorStateRef.current.getCurrentContent(), selection, value, editorStateRef.current.getCurrentInlineStyle(), entityKey);\n    var newEditorState = draft_js_1.EditorState.push(editorStateRef.current, contentState, \"insert-characters\");\n\n    if (autocompleteRef.current.insertSpaceAfter === false) {\n      handleChange(newEditorState);\n    } else {\n      var addSpaceState = draft_js_1.Modifier.insertText(newEditorState.getCurrentContent(), newEditorState.getSelection(), \" \", newEditorState.getCurrentInlineStyle());\n      handleChange(draft_js_1.EditorState.push(newEditorState, addSpaceState, \"insert-characters\"));\n    }\n  };\n\n  var handleAutocompleteSelected = function (index) {\n    var itemIndex = index || selectedIndex;\n    var items = getAutocompleteItems();\n\n    if (items.length > itemIndex) {\n      var item = items[itemIndex];\n      var currentSelection = autocompleteSelectionStateRef.current;\n      var offset = currentSelection.getFocusOffset() + searchTerm.length + 1;\n      var newSelection = currentSelection.merge({\n        'focusOffset': offset\n      });\n\n      if (autocompleteRef.current.atomicBlockName) {\n        var name_1 = autocompleteRef.current.atomicBlockName;\n        insertAutocompleteSuggestionAsAtomicBlock(name_1, newSelection, item.value);\n      } else {\n        insertAutocompleteSuggestionAsText(newSelection, item.value);\n      }\n    }\n\n    handleAutocompleteClosed();\n  };\n\n  var handleAutocompleteClosed = function () {\n    clearSearch();\n    setSelectedIndex(0);\n    refocus();\n  };\n\n  var getAutocompleteItems = function () {\n    if (searchTerm.length < autocompleteMinSearchCharCount) {\n      return [];\n    }\n\n    return autocompleteRef.current.items.filter(function (item) {\n      return item.keys.filter(function (key) {\n        return key.includes(searchTerm);\n      }).length > 0;\n    }).splice(0, autocompleteLimit);\n  };\n\n  var handleChange = function (state) {\n    setEditorState(state);\n  };\n\n  var handleBeforeInput = function (chars, editorState) {\n    if (chars === \" \" && searchTerm.length) {\n      clearSearch();\n    } else if (autocompleteSelectionStateRef.current) {\n      setSearchTerm(searchTerm + chars);\n    } else {\n      var strategy = findAutocompleteStrategy(chars);\n\n      if (strategy) {\n        autocompleteRef.current = strategy;\n        updateAutocompletePosition();\n      }\n    }\n\n    return isMaxLengthHandled(editorState, 1);\n  };\n\n  var handleEditorFocus = function () {\n    handleFocus();\n\n    if (isFocusedWithMouse.current === true) {\n      isFocusedWithMouse.current = false;\n      return;\n    }\n\n    var nextEditorState = draft_js_1.EditorState.forceSelection(editorState, editorState.getSelection());\n    setTimeout(function () {\n      return setEditorState(draft_js_1.EditorState.moveFocusToEnd(nextEditorState));\n    }, 0);\n  };\n\n  var handlePlaceholderFocus = function () {\n    if (isFirstFocus.current === false) {\n      focusEditor();\n      return;\n    }\n\n    handleFocus();\n    isFirstFocus.current = false;\n  };\n\n  var handleFocus = function () {\n    focusEditor();\n\n    if (props.onFocus) {\n      props.onFocus();\n    }\n  };\n\n  var focusEditor = function () {\n    setFocus(true);\n    setTimeout(function () {\n      var _a;\n\n      return (_a = editorRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n    }, 0);\n  };\n\n  var handleBlur = function () {\n    isFocusedWithMouse.current = false;\n    setFocus(false);\n\n    if (props.onBlur) {\n      props.onBlur();\n    }\n\n    if (!state.anchorUrlPopover) {\n      setState(__assign(__assign({}, state), {\n        toolbarPosition: undefined\n      }));\n    }\n  };\n\n  var handleMouseDown = function () {\n    isFocusedWithMouse.current = true;\n  };\n\n  var handleClearFormat = function () {\n    if (customStyleMapRef.current === undefined) {\n      return;\n    }\n\n    var withoutStyles = (0, utils_1.clearInlineStyles)(editorState, customStyleMapRef.current);\n    var selectionInfo = (0, utils_1.getSelectionInfo)(editorState);\n    var newEditorState = draft_js_1.EditorState.push(editorState, withoutStyles, 'change-inline-style');\n    setEditorState(draft_js_1.RichUtils.toggleBlockType(newEditorState, selectionInfo.blockType));\n  };\n\n  var handleSave = function () {\n    if (props.onSave) {\n      props.onSave(JSON.stringify((0, draft_js_1.convertToRaw)(editorState.getCurrentContent())));\n    }\n  };\n\n  var handleInsertAtomicBlockSync = function (name, data) {\n    var block = (0, utils_1.atomicBlockExists)(name, props.customControls);\n\n    if (!block) {\n      return;\n    }\n\n    var newEditorState = insertAtomicBlock(editorState, block.name.toUpperCase(), data, {\n      selection: editorState.getCurrentContent().getSelectionAfter()\n    });\n    updateStateForPopover(newEditorState);\n  };\n\n  var handleInsertAtomicBlockAsync = function (name, promise, placeholder) {\n    var selection = insertAsyncAtomicBlockPlaceholder(name, placeholder);\n    var offset = selection.getFocusOffset() + 1;\n    var newSelection = selection.merge({\n      'focusOffset': offset\n    });\n    promise.then(function (response) {\n      var newEditorState = insertAtomicBlock(editorStateRef.current, name, response.data, {\n        selection: newSelection\n      });\n      handleChange(newEditorState);\n    }).catch(function (error) {\n      if (error) {\n        return;\n      }\n\n      var newContentState = draft_js_1.Modifier.removeRange(editorStateRef.current.getCurrentContent(), newSelection, \"forward\");\n      handleChange(draft_js_1.EditorState.push(editorStateRef.current, newContentState, \"remove-range\"));\n    });\n  };\n\n  var insertAsyncAtomicBlockPlaceholder = function (name, placeholder) {\n    var placeholderName = placeholder || name + \"...\";\n    var currentContentState = editorStateRef.current.getCurrentContent();\n    var entityKey = currentContentState.createEntity(\"ASYNC_ATOMICBLOCK\", 'IMMUTABLE').getLastCreatedEntityKey();\n    var contentState = draft_js_1.Modifier.insertText(editorStateRef.current.getCurrentContent(), currentContentState.getSelectionAfter(), placeholderName, undefined, entityKey);\n    var selection = currentContentState.getSelectionAfter();\n    var newEditorState = draft_js_1.EditorState.push(editorStateRef.current, contentState, \"insert-characters\");\n    handleChange(newEditorState);\n    return selection;\n  };\n\n  var handleKeyCommand = function (command, editorState) {\n    var newState = draft_js_1.RichUtils.handleKeyCommand(editorState, command);\n\n    if (newState) {\n      handleChange(newState);\n      return \"handled\";\n    } else {\n      if (command.includes(\"mui-autocomplete\")) {\n        if (command === \"mui-autocomplete-insert\") {\n          handleAutocompleteSelected();\n        }\n\n        if (command === \"mui-autocomplete-end\") {\n          handleAutocompleteClosed();\n        }\n\n        return \"handled\";\n      }\n\n      if (props.keyCommands) {\n        var keyCommand = props.keyCommands.find(function (comm) {\n          return comm.name === command;\n        });\n\n        if (keyCommand) {\n          var newState_1 = keyCommand.callback(editorState);\n          handleChange(newState_1);\n          return \"handled\";\n        }\n      }\n    }\n\n    return \"not-handled\";\n  };\n\n  var handleCustomClick = function (style, id) {\n    if (!props.customControls) {\n      return;\n    }\n\n    for (var _i = 0, _a = props.customControls; _i < _a.length; _i++) {\n      var control = _a[_i];\n\n      if (control.name.toUpperCase() === style) {\n        if (control.onClick) {\n          setTimeout(function () {\n            var _a;\n\n            return (_a = editorRef.current) === null || _a === void 0 ? void 0 : _a.blur();\n          }, 0);\n          var newState = control.onClick(editorState, control.name, document.getElementById(id));\n\n          if (newState) {\n            if (newState.getSelection().isCollapsed()) {\n              setEditorState(newState);\n            } else {\n              updateStateForPopover(newState);\n            }\n          } else {\n            if (!editorState.getSelection().isCollapsed()) {\n              refocus();\n            }\n          }\n        }\n\n        break;\n      }\n    }\n  };\n\n  var handleUndo = function () {\n    setEditorState(draft_js_1.EditorState.undo(editorState));\n  };\n\n  var handleRedo = function () {\n    setEditorState(draft_js_1.EditorState.redo(editorState));\n  };\n\n  var handlePrompt = function (lastState, type, inlineMode) {\n    var selectionInfo = (0, utils_1.getSelectionInfo)(lastState);\n    var contentState = lastState.getCurrentContent();\n    var linkKey = selectionInfo.linkKey;\n    var data = undefined;\n\n    if (linkKey) {\n      var linkInstance = contentState.getEntity(linkKey);\n      data = linkInstance.getData();\n    }\n\n    setState({\n      urlData: data,\n      urlKey: linkKey,\n      toolbarPosition: !inlineMode ? undefined : state.toolbarPosition,\n      anchorUrlPopover: !inlineMode ? document.getElementById(editorId + \"-\" + type + \"-control-button\") : document.getElementById(editorId + \"-\" + type + \"-control-button-toolbar\"),\n      urlIsMedia: type === \"media\" ? true : undefined\n    });\n  };\n\n  var handlePromptForLink = function (inlineMode) {\n    var selection = editorState.getSelection();\n\n    if (!selection.isCollapsed()) {\n      handlePrompt(editorState, \"link\", inlineMode);\n    }\n  };\n\n  var handlePromptForMedia = function (inlineMode, newState) {\n    var lastState = newState || editorState;\n    handlePrompt(lastState, \"media\", inlineMode);\n  };\n\n  var handleConfirmPrompt = function (isMedia) {\n    var args = [];\n\n    for (var _i = 1; _i < arguments.length; _i++) {\n      args[_i - 1] = arguments[_i];\n    }\n\n    if (isMedia) {\n      confirmMedia.apply(void 0, args);\n      return;\n    }\n\n    confirmLink.apply(void 0, args);\n  };\n\n  var handleToolbarClick = function (style, type, id, inlineMode) {\n    if (type === \"inline\") {\n      return toggleInlineStyle(style);\n    }\n\n    if (type === \"block\") {\n      return toggleBlockType(style);\n    }\n\n    switch (style) {\n      case \"UNDO\":\n        handleUndo();\n        break;\n\n      case \"REDO\":\n        handleRedo();\n        break;\n\n      case \"LINK\":\n        handlePromptForLink(inlineMode);\n        break;\n\n      case \"IMAGE\":\n        handlePromptForMedia(inlineMode);\n        break;\n\n      case \"clear\":\n        handleClearFormat();\n        break;\n\n      case \"save\":\n        handleSave();\n        break;\n\n      default:\n        handleCustomClick(style, id);\n    }\n  };\n\n  var handlePastedText = function (text, _html, editorState) {\n    return isMaxLengthHandled(editorState, text.length);\n  };\n\n  var handleReturn = function (_e, editorState) {\n    return isMaxLengthHandled(editorState, 1);\n  };\n\n  var isMaxLengthHandled = function (editorState, nextLength) {\n    var currentLength = editorState.getCurrentContent().getPlainText('').length;\n    return (0, utils_1.isGreaterThan)(currentLength + nextLength, props.maxLength) ? \"handled\" : \"not-handled\";\n  };\n\n  var toggleMouseUpListener = function (addAfter) {\n    var _a;\n\n    if (addAfter === void 0) {\n      addAfter = false;\n    }\n\n    var editor = (_a = editorRef.current) === null || _a === void 0 ? void 0 : _a.editor;\n\n    if (!editor) {\n      return;\n    }\n\n    editor.removeEventListener(\"mouseup\", handleMouseUp);\n\n    if (addAfter) {\n      editor.addEventListener(\"mouseup\", handleMouseUp);\n    }\n  };\n\n  var removeLink = function () {\n    var selection = editorState.getSelection();\n    setEditorState(draft_js_1.RichUtils.toggleLink(editorState, selection, null));\n  };\n\n  var confirmLink = function (url) {\n    var urlKey = state.urlKey;\n\n    if (!url) {\n      if (urlKey) {\n        removeLink();\n      }\n\n      dismissPopover();\n      return;\n    }\n\n    var contentState = editorState.getCurrentContent();\n    var replaceEditorState = editorState;\n    var data = {\n      url: url,\n      className: classes.anchorLink\n    };\n\n    if (urlKey) {\n      contentState.replaceEntityData(urlKey, data);\n      replaceEditorState = draft_js_1.EditorState.push(editorState, contentState, \"apply-entity\");\n    } else {\n      var contentStateWithEntity = contentState.createEntity('LINK', 'MUTABLE', data);\n      var entityKey = contentStateWithEntity.getLastCreatedEntityKey();\n      var newEditorState = draft_js_1.EditorState.set(editorState, {\n        currentContent: contentStateWithEntity\n      });\n      replaceEditorState = draft_js_1.RichUtils.toggleLink(newEditorState, newEditorState.getSelection(), entityKey);\n    }\n\n    updateStateForPopover(replaceEditorState);\n  };\n\n  var removeMedia = function () {\n    var blockKey = editorState.getSelection().getStartKey();\n    var contentState = editorState.getCurrentContent();\n    var mediaBlock = contentState.getBlockForKey(blockKey);\n    var newContentState = (0, utils_1.removeBlockFromMap)(editorState, mediaBlock);\n    var newEditorState = draft_js_1.EditorState.push(editorState, newContentState, \"remove-range\");\n    setEditorState(newEditorState);\n  };\n\n  var confirmMedia = function (url, width, height, alignment, type) {\n    var urlKey = state.urlKey;\n\n    if (!url) {\n      if (urlKey) {\n        removeMedia();\n      }\n\n      dismissPopover();\n      return;\n    }\n\n    var contentState = editorState.getCurrentContent();\n    var data = {\n      url: url,\n      width: width,\n      height: height,\n      alignment: alignment,\n      type: type\n    };\n\n    if (urlKey) {\n      contentState.replaceEntityData(urlKey, data);\n      var newEditorState = draft_js_1.EditorState.push(editorState, contentState, \"apply-entity\");\n      updateStateForPopover(draft_js_1.EditorState.forceSelection(newEditorState, newEditorState.getCurrentContent().getSelectionAfter()));\n    } else {\n      var newEditorState = insertAtomicBlock(editorState, \"IMAGE\", data);\n      updateStateForPopover(draft_js_1.EditorState.forceSelection(newEditorState, newEditorState.getCurrentContent().getSelectionAfter()));\n    }\n\n    setFocusMediaKey(\"\");\n  };\n\n  var updateStateForPopover = function (editorState) {\n    setEditorState(editorState);\n    dismissPopover();\n  };\n\n  var dismissPopover = function () {\n    refocus();\n    setState(__assign(__assign({}, state), {\n      anchorUrlPopover: undefined,\n      urlKey: undefined,\n      urlIsMedia: undefined,\n      urlData: undefined\n    }));\n  };\n\n  var refocus = function () {\n    setTimeout(function () {\n      var _a;\n\n      return (_a = editorRef.current) === null || _a === void 0 ? void 0 : _a.blur();\n    }, 0);\n    setTimeout(function () {\n      var _a;\n\n      return (_a = editorRef.current) === null || _a === void 0 ? void 0 : _a.focus();\n    }, 1);\n  };\n\n  var toggleBlockType = function (blockType) {\n    setEditorState(draft_js_1.RichUtils.toggleBlockType(editorState, blockType));\n  };\n\n  var toggleInlineStyle = function (inlineStyle) {\n    setEditorState(draft_js_1.RichUtils.toggleInlineStyle(editorState, inlineStyle));\n  };\n\n  var focusMedia = function (block) {\n    var newSeletion = draft_js_1.SelectionState.createEmpty(block.getKey());\n    var newEditorState = draft_js_1.EditorState.forceSelection(editorStateRef.current, newSeletion);\n    editorStateRef.current = newEditorState;\n    setFocusMediaKey(block.getKey());\n    setEditorState(newEditorState);\n    handlePromptForMedia(false, newEditorState);\n  };\n\n  var getStyleMap = function () {\n    if (customStyleMapRef.current === undefined) {\n      setupStyleMap();\n    }\n\n    return customStyleMapRef.current;\n  };\n\n  var setupStyleMap = function () {\n    var _a;\n\n    var customStyleMap = JSON.parse(JSON.stringify(styleRenderMap));\n    (_a = props.customControls) === null || _a === void 0 ? void 0 : _a.filter(function (control) {\n      return control.type === \"inline\" && control.inlineStyle;\n    }).forEach(function (control) {\n      customStyleMap[control.name.toUpperCase()] = control.inlineStyle;\n    });\n    customStyleMapRef.current = customStyleMap;\n  };\n\n  var getBlockMap = function () {\n    if (customBlockMapRef.current === undefined) {\n      setupBlockMap();\n    }\n\n    return customBlockMapRef.current;\n  };\n\n  var setupBlockMap = function () {\n    var _a;\n\n    var customBlockMap = {};\n    (_a = props.customControls) === null || _a === void 0 ? void 0 : _a.filter(function (control) {\n      return control.type === \"block\" && control.blockWrapper;\n    }).forEach(function (control) {\n      customBlockMap[control.name.toUpperCase()] = {\n        element: \"div\",\n        wrapper: control.blockWrapper\n      };\n    });\n    customBlockMapRef.current = draft_js_1.DefaultDraftBlockRenderMap.merge(blockRenderMap, immutable_1.default.Map(customBlockMap));\n  };\n\n  var blockRenderer = function (contentBlock) {\n    var blockType = contentBlock.getType();\n\n    if (blockType === 'atomic') {\n      var contentState = editorState.getCurrentContent();\n      var entity = contentBlock.getEntityAt(0);\n\n      if (entity) {\n        var type = contentState.getEntity(entity).getType();\n\n        if (type === \"IMAGE\") {\n          return {\n            component: Media_1.default,\n            editable: false,\n            props: {\n              onClick: focusMedia,\n              readOnly: props.readOnly,\n              focusKey: focusMediaKey\n            }\n          };\n        } else {\n          var block = (0, utils_1.atomicBlockExists)(type.toLowerCase(), props.customControls);\n\n          if (block) {\n            return {\n              component: block.atomicComponent,\n              editable: false,\n              props: contentState.getEntity(contentBlock.getEntityAt(0)).getData()\n            };\n          }\n        }\n      }\n    }\n\n    return null;\n  };\n\n  var styleRenderer = function (style) {\n    var customStyleMap = getStyleMap();\n    var styleNames = style.toJS();\n    return styleNames.reduce(function (styles, styleName) {\n      styles = customStyleMap[styleName];\n      return styles;\n    }, {});\n  };\n\n  var insertAtomicBlock = function (editorState, type, data, options) {\n    var contentState = editorState.getCurrentContent();\n    var contentStateWithEntity = contentState.createEntity(type, 'IMMUTABLE', data);\n    var entityKey = contentStateWithEntity.getLastCreatedEntityKey();\n    var newEditorStateRaw = draft_js_1.EditorState.set(editorState, __assign({\n      currentContent: contentStateWithEntity\n    }, options));\n    return draft_js_1.AtomicBlockUtils.insertAtomicBlock(newEditorStateRaw, entityKey, ' ');\n  };\n\n  var getAutocompleteKeyEvent = function (keyboardEvent) {\n    var itemsLength = getAutocompleteItems().length;\n    var limit = autocompleteLimit > itemsLength ? itemsLength : autocompleteLimit;\n\n    switch (keyboardEvent.key) {\n      case \"ArrowDown\":\n        if (selectedIndex === 0 && itemsLength === 1 || selectedIndex + 1 === limit) {\n          setSelectedIndex(0);\n        } else {\n          setSelectedIndex(selectedIndex + 1 < limit ? selectedIndex + 1 : selectedIndex);\n        }\n\n        return \"mui-autocomplete-navigate\";\n\n      case \"ArrowUp\":\n        if (selectedIndex) {\n          setSelectedIndex(selectedIndex - 1);\n        } else {\n          setSelectedIndex(limit - 1);\n        }\n\n        return \"mui-autocomplete-navigate\";\n\n      case \"Enter\":\n        return \"mui-autocomplete-insert\";\n\n      case \"Escape\":\n        return \"mui-autocomplete-end\";\n\n      default:\n        return null;\n    }\n  };\n\n  var updateSearchTermForKeyBinding = function (keyBinding) {\n    var text = editorStateRef.current.getCurrentContent().getLastBlock().getText();\n\n    if (keyBinding === \"backspace\" && autocompleteRef.current && text.substr(text.length - 1) === autocompleteRef.current.triggerChar) {\n      clearSearch();\n    } else if (autocompletePositionRef.current && keyBinding === \"backspace\" && searchTerm.length) {\n      setSearchTerm(searchTerm.substr(0, searchTerm.length - 1));\n    } else if (!autocompletePositionRef.current && (keyBinding === \"backspace\" || keyBinding === \"split-block\")) {\n      clearSearch();\n    }\n  };\n\n  var keyBindingFn = function (e) {\n    if (hasCommandModifier(e) && props.keyCommands) {\n      var comm = props.keyCommands.find(function (comm) {\n        return comm.key === e.keyCode;\n      });\n\n      if (comm) {\n        return comm.name;\n      }\n    }\n\n    if (searchTerm) {\n      var autocompleteEvent = getAutocompleteKeyEvent(e);\n\n      if (autocompleteEvent) {\n        return autocompleteEvent;\n      }\n    }\n\n    var keyBinding = (0, draft_js_1.getDefaultKeyBinding)(e);\n    updateSearchTermForKeyBinding(keyBinding);\n    return keyBinding;\n  };\n\n  var renderToolbar = props.toolbar === undefined || props.toolbar;\n  var inlineToolbarControls = props.inlineToolbarControls || defaultInlineToolbarControls;\n  var editable = props.readOnly === undefined || !props.readOnly;\n  var className = \"\";\n  var placeholder = null;\n\n  if (!focus) {\n    var contentState = editorState.getCurrentContent();\n\n    if (!contentState.hasText()) {\n      placeholder = react_1.default.createElement(\"div\", {\n        className: (0, classnames_1.default)(classes.editorContainer, classes.placeHolder, (_a = {}, _a[classes.error] = props.error, _a)),\n        tabIndex: 0,\n        onFocus: handlePlaceholderFocus\n      }, props.label || \"\");\n      className = classes.hidePlaceholder;\n    }\n  }\n\n  return react_1.default.createElement(\"div\", {\n    id: editorId + \"-root\",\n    className: classes.root\n  }, react_1.default.createElement(\"div\", {\n    id: editorId + \"-container\",\n    className: (0, classnames_1.default)(classes.container, (_b = {}, _b[classes.inheritFontSize] = props.inheritFontSize, _b))\n  }, props.autocomplete && autocompletePositionRef.current ? react_1.default.createElement(Autocomplete_1.default, {\n    items: getAutocompleteItems(),\n    top: autocompletePositionRef.current.top,\n    left: autocompletePositionRef.current.left,\n    onClick: handleAutocompleteSelected,\n    selectedIndex: selectedIndex\n  }) : null, props.inlineToolbar && editable && state.toolbarPosition ? react_1.default.createElement(material_1.Paper, {\n    className: classes.inlineToolbar,\n    style: {\n      top: state.toolbarPosition.top,\n      left: state.toolbarPosition.left\n    }\n  }, react_1.default.createElement(Toolbar_1.default, {\n    id: editorId,\n    editorState: editorState,\n    onClick: handleToolbarClick,\n    controls: inlineToolbarControls,\n    customControls: customControls,\n    inlineMode: true,\n    isActive: true\n  })) : null, renderToolbar ? react_1.default.createElement(Toolbar_1.default, {\n    id: editorId,\n    editorState: editorState,\n    onClick: handleToolbarClick,\n    controls: controls,\n    customControls: customControls,\n    className: classes.toolbar,\n    disabled: !editable,\n    size: props.toolbarButtonSize,\n    isActive: focus\n  }) : null, placeholder, react_1.default.createElement(\"div\", {\n    id: editorId + \"-editor\",\n    className: classes.editor\n  }, react_1.default.createElement(\"div\", {\n    id: editorId + \"-editor-container\",\n    className: (0, classnames_1.default)(className, classes.editorContainer, (_c = {}, _c[classes.editorReadOnly] = !editable, _c[classes.error] = props.error, _c)),\n    onMouseDown: handleMouseDown,\n    onBlur: handleBlur\n  }, react_1.default.createElement(draft_js_1.Editor, __assign({\n    blockRenderMap: getBlockMap(),\n    blockRendererFn: blockRenderer,\n    customStyleFn: styleRenderer,\n    editorState: editorState,\n    onChange: handleChange,\n    onFocus: handleEditorFocus,\n    readOnly: props.readOnly,\n    handleKeyCommand: handleKeyCommand,\n    handleBeforeInput: handleBeforeInput,\n    handlePastedText: handlePastedText,\n    handleReturn: handleReturn,\n    keyBindingFn: keyBindingFn,\n    ref: editorRef\n  }, props.draftEditorProps)))), state.anchorUrlPopover ? react_1.default.createElement(UrlPopover_1.default, {\n    data: state.urlData,\n    anchor: state.anchorUrlPopover,\n    onConfirm: handleConfirmPrompt,\n    isMedia: state.urlIsMedia\n  }) : null));\n};\n\nexports.default = (0, styles_1.withStyles)(styles, {\n  withTheme: true,\n  name: \"MUIRichTextEditor\"\n})((0, react_1.forwardRef)(MUIRichTextEditor));","map":{"version":3,"sources":["../src/MUIRichTextEditor.tsx"],"names":[],"mappings":"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","sourceRoot":"","sourcesContent":["\"use strict\";\nvar __assign = (this && this.__assign) || function () {\n    __assign = Object.assign || function(t) {\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\n            s = arguments[i];\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n                t[p] = s[p];\n        }\n        return t;\n    };\n    return __assign.apply(this, arguments);\n};\nvar __createBinding = (this && this.__createBinding) || (Object.create ? (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    Object.defineProperty(o, k2, { enumerable: true, get: function() { return m[k]; } });\n}) : (function(o, m, k, k2) {\n    if (k2 === undefined) k2 = k;\n    o[k2] = m[k];\n}));\nvar __setModuleDefault = (this && this.__setModuleDefault) || (Object.create ? (function(o, v) {\n    Object.defineProperty(o, \"default\", { enumerable: true, value: v });\n}) : function(o, v) {\n    o[\"default\"] = v;\n});\nvar __importStar = (this && this.__importStar) || function (mod) {\n    if (mod && mod.__esModule) return mod;\n    var result = {};\n    if (mod != null) for (var k in mod) if (k !== \"default\" && Object.prototype.hasOwnProperty.call(mod, k)) __createBinding(result, mod, k);\n    __setModuleDefault(result, mod);\n    return result;\n};\nvar __importDefault = (this && this.__importDefault) || function (mod) {\n    return (mod && mod.__esModule) ? mod : { \"default\": mod };\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar react_1 = __importStar(require(\"react\"));\nvar immutable_1 = __importDefault(require(\"immutable\"));\nvar classnames_1 = __importDefault(require(\"classnames\"));\nvar styles_1 = require(\"@mui/styles\");\nvar material_1 = require(\"@mui/material\");\nvar draft_js_1 = require(\"draft-js\");\nvar Toolbar_1 = __importDefault(require(\"./components/Toolbar\"));\nvar Link_1 = __importDefault(require(\"./components/Link\"));\nvar Media_1 = __importDefault(require(\"./components/Media\"));\nvar Blockquote_1 = __importDefault(require(\"./components/Blockquote\"));\nvar CodeBlock_1 = __importDefault(require(\"./components/CodeBlock\"));\nvar UrlPopover_1 = __importDefault(require(\"./components/UrlPopover\"));\nvar Autocomplete_1 = __importDefault(require(\"./components/Autocomplete\"));\nvar utils_1 = require(\"./utils\");\nvar styles = function (theme) {\n    var _a, _b, _c, _d, _f, _g, _h, _j, _k, _l, _m, _o, _p, _q, _r, _s, _t, _u, _v, _w, _x, _y, _z, _0, _1, _2, _3, _4;\n    return (0, styles_1.createStyles)({\n        root: ((_b = (_a = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _a === void 0 ? void 0 : _a.MUIRichTextEditor) === null || _b === void 0 ? void 0 : _b.root) || {},\n        container: ((_d = (_c = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _c === void 0 ? void 0 : _c.MUIRichTextEditor) === null || _d === void 0 ? void 0 : _d.container) || {\n            margin: theme.spacing(1, 0, 0, 0),\n            position: \"relative\",\n            fontFamily: theme.typography.body1.fontFamily,\n            fontSize: theme.typography.body1.fontSize,\n            '& figure': {\n                margin: 0\n            }\n        },\n        inheritFontSize: ((_g = (_f = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _f === void 0 ? void 0 : _f.MUIRichTextEditor) === null || _g === void 0 ? void 0 : _g.inheritFontSize) || {\n            fontSize: \"inherit\"\n        },\n        editor: ((_j = (_h = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _h === void 0 ? void 0 : _h.MUIRichTextEditor) === null || _j === void 0 ? void 0 : _j.editor) || {},\n        editorContainer: ((_l = (_k = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _k === void 0 ? void 0 : _k.MUIRichTextEditor) === null || _l === void 0 ? void 0 : _l.editorContainer) || {\n            margin: theme.spacing(1, 0, 0, 0),\n            cursor: \"text\",\n            width: \"100%\",\n            padding: theme.spacing(0, 0, 1, 0)\n        },\n        editorReadOnly: ((_o = (_m = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _m === void 0 ? void 0 : _m.MUIRichTextEditor) === null || _o === void 0 ? void 0 : _o.editorReadOnly) || {\n            borderBottom: \"none\"\n        },\n        error: ((_q = (_p = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _p === void 0 ? void 0 : _p.MUIRichTextEditor) === null || _q === void 0 ? void 0 : _q.error) || {\n            borderBottom: \"2px solid red\"\n        },\n        hidePlaceholder: ((_s = (_r = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _r === void 0 ? void 0 : _r.MUIRichTextEditor) === null || _s === void 0 ? void 0 : _s.hidePlaceholder) || {\n            display: \"none\"\n        },\n        placeHolder: ((_u = (_t = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _t === void 0 ? void 0 : _t.MUIRichTextEditor) === null || _u === void 0 ? void 0 : _u.placeHolder) || {\n            color: theme.palette.grey[600],\n            position: \"absolute\",\n            outline: \"none\"\n        },\n        linkPopover: ((_w = (_v = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _v === void 0 ? void 0 : _v.MUIRichTextEditor) === null || _w === void 0 ? void 0 : _w.linkPopover) || {\n            padding: theme.spacing(2, 2, 2, 2)\n        },\n        linkTextField: ((_y = (_x = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _x === void 0 ? void 0 : _x.MUIRichTextEditor) === null || _y === void 0 ? void 0 : _y.linkTextField) || {\n            width: \"100%\"\n        },\n        anchorLink: ((_0 = (_z = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _z === void 0 ? void 0 : _z.MUIRichTextEditor) === null || _0 === void 0 ? void 0 : _0.anchorLink) || {},\n        toolbar: ((_2 = (_1 = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _1 === void 0 ? void 0 : _1.MUIRichTextEditor) === null || _2 === void 0 ? void 0 : _2.toolbar) || {},\n        inlineToolbar: ((_4 = (_3 = theme === null || theme === void 0 ? void 0 : theme.overrides) === null || _3 === void 0 ? void 0 : _3.MUIRichTextEditor) === null || _4 === void 0 ? void 0 : _4.inlineToolbar) || {\n            maxWidth: \"180px\",\n            position: \"absolute\",\n            padding: \"5px\",\n            zIndex: 10\n        }\n    });\n};\nvar blockRenderMap = immutable_1.default.Map({\n    'blockquote': {\n        element: \"blockquote\",\n        wrapper: react_1.default.createElement(Blockquote_1.default, null)\n    },\n    'code-block': {\n        element: \"pre\",\n        wrapper: react_1.default.createElement(CodeBlock_1.default, null)\n    }\n});\nvar styleRenderMap = {\n    'STRIKETHROUGH': {\n        textDecoration: \"line-through\"\n    },\n    'HIGHLIGHT': {\n        backgroundColor: \"yellow\"\n    }\n};\nvar hasCommandModifier = draft_js_1.KeyBindingUtil.hasCommandModifier;\nvar autocompleteMinSearchCharCount = 2;\nvar lineHeight = 26;\nvar defaultInlineToolbarControls = [\"bold\", \"italic\", \"underline\", \"clear\"];\nvar findLinkEntities = function (contentBlock, callback, contentState) {\n    contentBlock.findEntityRanges(function (character) {\n        var entityKey = character.getEntity();\n        return (entityKey !== null &&\n            contentState.getEntity(entityKey).getType() === 'LINK');\n    }, callback);\n};\nvar findDecoWithRegex = function (regex, contentBlock, callback) {\n    var text = contentBlock.getText();\n    var matchArr, start;\n    while ((matchArr = regex.exec(text)) !== null) {\n        start = matchArr.index;\n        callback(start, start + matchArr[0].length);\n    }\n};\nvar useEditorState = function (props) {\n    var decorators = [\n        {\n            strategy: findLinkEntities,\n            component: Link_1.default,\n        }\n    ];\n    if (props.decorators) {\n        props.decorators.forEach(function (deco) { return decorators.push({\n            strategy: function (contentBlock, callback) {\n                findDecoWithRegex(deco.regex, contentBlock, callback);\n            },\n            component: deco.component\n        }); });\n    }\n    var decorator = new draft_js_1.CompositeDecorator(decorators);\n    var defaultValue = props.defaultValue || props.value;\n    return (defaultValue)\n        ? draft_js_1.EditorState.createWithContent((0, draft_js_1.convertFromRaw)(JSON.parse(defaultValue)), decorator)\n        : draft_js_1.EditorState.createEmpty(decorator);\n};\nvar MUIRichTextEditor = function (props, ref) {\n    var _a, _b, _c;\n    var classes = props.classes, controls = props.controls, customControls = props.customControls;\n    var _d = (0, react_1.useState)({}), state = _d[0], setState = _d[1];\n    var _f = (0, react_1.useState)(false), focus = _f[0], setFocus = _f[1];\n    var _g = (0, react_1.useState)(\"\"), searchTerm = _g[0], setSearchTerm = _g[1];\n    var _h = (0, react_1.useState)(0), selectedIndex = _h[0], setSelectedIndex = _h[1];\n    var _j = (0, react_1.useState)(function () { return useEditorState(props); }), editorState = _j[0], setEditorState = _j[1];\n    var _k = (0, react_1.useState)(\"\"), focusMediaKey = _k[0], setFocusMediaKey = _k[1];\n    var editorRef = (0, react_1.useRef)(null);\n    var editorId = props.id || \"mui-rte\";\n    var toolbarPositionRef = (0, react_1.useRef)(undefined);\n    var editorStateRef = (0, react_1.useRef)(editorState);\n    var autocompleteRef = (0, react_1.useRef)(undefined);\n    var autocompleteSelectionStateRef = (0, react_1.useRef)(undefined);\n    var autocompletePositionRef = (0, react_1.useRef)(undefined);\n    var autocompleteLimit = props.autocomplete ? props.autocomplete.suggestLimit || 5 : 5;\n    var isFirstFocus = (0, react_1.useRef)(true);\n    var customBlockMapRef = (0, react_1.useRef)(undefined);\n    var customStyleMapRef = (0, react_1.useRef)(undefined);\n    var isFocusedWithMouse = (0, react_1.useRef)(false);\n    var selectionRef = (0, react_1.useRef)({\n        start: 0,\n        end: 0\n    });\n    /**\n     * Exposed methods\n     */\n    (0, react_1.useImperativeHandle)(ref, function () { return ({\n        focus: function () {\n            handleFocus();\n        },\n        save: function () {\n            handleSave();\n        },\n        insertAtomicBlock: function (name, data) {\n            handleInsertAtomicBlockSync(name, data);\n        },\n        insertAtomicBlockSync: function (name, data) {\n            handleInsertAtomicBlockSync(name, data);\n        },\n        insertAtomicBlockAsync: function (name, promise, placeholder) {\n            handleInsertAtomicBlockAsync(name, promise, placeholder);\n        }\n    }); });\n    (0, react_1.useEffect)(function () {\n        var editorState = useEditorState(props);\n        setEditorState(editorState);\n        toggleMouseUpListener(true);\n        return function () {\n            toggleMouseUpListener();\n        };\n    }, [props.value, props.defaultValue]);\n    (0, react_1.useEffect)(function () {\n        if (props.onChange) {\n            props.onChange(editorState);\n        }\n        editorStateRef.current = editorState;\n    }, [editorState]);\n    (0, react_1.useEffect)(function () {\n        toolbarPositionRef.current = state.toolbarPosition;\n    }, [state.toolbarPosition]);\n    (0, react_1.useEffect)(function () {\n        if (searchTerm.length < autocompleteMinSearchCharCount) {\n            setSelectedIndex(0);\n        }\n    }, [searchTerm]);\n    var clearSearch = function () {\n        setSearchTerm(\"\");\n        autocompletePositionRef.current = undefined;\n        autocompleteSelectionStateRef.current = undefined;\n    };\n    var handleMouseUp = function (event) {\n        var nodeName = event.target.nodeName;\n        clearSearch();\n        if (nodeName === \"IMG\" || nodeName === \"VIDEO\") {\n            return;\n        }\n        setTimeout(function () {\n            var _a;\n            var selection = editorStateRef.current.getSelection();\n            if (selection.isCollapsed() || (toolbarPositionRef !== undefined &&\n                selectionRef.current.start === selection.getStartOffset() &&\n                selectionRef.current.end === selection.getEndOffset())) {\n                var selectionInfo = (0, utils_1.getSelectionInfo)(editorStateRef.current);\n                if (selectionInfo.entityType === \"IMAGE\") {\n                    focusMedia(selectionInfo.block);\n                    return;\n                }\n                setState(__assign(__assign({}, state), { toolbarPosition: undefined }));\n                return;\n            }\n            selectionRef.current = {\n                start: selection.getStartOffset(),\n                end: selection.getEndOffset()\n            };\n            var editor = (_a = editorRef.current) === null || _a === void 0 ? void 0 : _a.editor;\n            if (!editor) {\n                return;\n            }\n            var _b = (0, utils_1.getEditorBounds)(editor), editorRect = _b.editorRect, selectionRect = _b.selectionRect;\n            if (!selectionRect) {\n                return;\n            }\n            var position = {\n                top: editor.offsetTop - 48 + (selectionRect.top - editorRect.top),\n                left: editor.offsetLeft + (selectionRect.left - editorRect.left)\n            };\n            setState(__assign(__assign({}, state), { toolbarPosition: position }));\n        }, 1);\n    };\n    var findAutocompleteStrategy = function (chars) {\n        if (!props.autocomplete) {\n            return undefined;\n        }\n        var acArray = props.autocomplete.strategies.filter(function (ac) { return ac.triggerChar === chars; });\n        if (acArray.length) {\n            return acArray[0];\n        }\n        return undefined;\n    };\n    var updateAutocompletePosition = function () {\n        var _a;\n        var editor = (_a = editorRef.current) === null || _a === void 0 ? void 0 : _a.editor;\n        if (!editor) {\n            return;\n        }\n        var _b = (0, utils_1.getEditorBounds)(editor), editorRect = _b.editorRect, selectionRect = _b.selectionRect;\n        var line = (0, utils_1.getLineNumber)(editorState);\n        var top = selectionRect ? selectionRect.top : editorRect.top + (lineHeight * line);\n        var left = selectionRect ? selectionRect.left : editorRect.left;\n        var position = {\n            top: editor.offsetTop + (top - editorRect.top) + lineHeight,\n            left: editor.offsetLeft + (left - editorRect.left)\n        };\n        if (!autocompleteSelectionStateRef.current) {\n            autocompleteSelectionStateRef.current = editorStateRef.current.getSelection();\n        }\n        autocompletePositionRef.current = position;\n    };\n    var insertAutocompleteSuggestionAsAtomicBlock = function (name, selection, value) {\n        var block = (0, utils_1.atomicBlockExists)(name, props.customControls);\n        if (!block) {\n            return;\n        }\n        var contentState = draft_js_1.Modifier.removeRange(editorStateRef.current.getCurrentContent(), selection, \"forward\");\n        var newEditorState = draft_js_1.EditorState.push(editorStateRef.current, contentState, \"remove-range\");\n        var withAtomicBlock = insertAtomicBlock(newEditorState, name.toUpperCase(), {\n            value: value\n        }, {\n            selection: newEditorState.getCurrentContent().getSelectionAfter()\n        });\n        handleChange(withAtomicBlock);\n    };\n    var insertAutocompleteSuggestionAsText = function (selection, value) {\n        var currentContentState = editorState.getCurrentContent();\n        var entityKey = currentContentState.createEntity(\"AC_ITEM\", 'IMMUTABLE').getLastCreatedEntityKey();\n        var contentState = draft_js_1.Modifier.replaceText(editorStateRef.current.getCurrentContent(), selection, value, editorStateRef.current.getCurrentInlineStyle(), entityKey);\n        var newEditorState = draft_js_1.EditorState.push(editorStateRef.current, contentState, \"insert-characters\");\n        if (autocompleteRef.current.insertSpaceAfter === false) {\n            handleChange(newEditorState);\n        }\n        else {\n            var addSpaceState = draft_js_1.Modifier.insertText(newEditorState.getCurrentContent(), newEditorState.getSelection(), \" \", newEditorState.getCurrentInlineStyle());\n            handleChange(draft_js_1.EditorState.push(newEditorState, addSpaceState, \"insert-characters\"));\n        }\n    };\n    var handleAutocompleteSelected = function (index) {\n        var itemIndex = index || selectedIndex;\n        var items = getAutocompleteItems();\n        if (items.length > itemIndex) {\n            var item = items[itemIndex];\n            var currentSelection = autocompleteSelectionStateRef.current;\n            var offset = currentSelection.getFocusOffset() + searchTerm.length + 1;\n            var newSelection = currentSelection.merge({\n                'focusOffset': offset\n            });\n            if (autocompleteRef.current.atomicBlockName) {\n                var name_1 = autocompleteRef.current.atomicBlockName;\n                insertAutocompleteSuggestionAsAtomicBlock(name_1, newSelection, item.value);\n            }\n            else {\n                insertAutocompleteSuggestionAsText(newSelection, item.value);\n            }\n        }\n        handleAutocompleteClosed();\n    };\n    var handleAutocompleteClosed = function () {\n        clearSearch();\n        setSelectedIndex(0);\n        refocus();\n    };\n    var getAutocompleteItems = function () {\n        if (searchTerm.length < autocompleteMinSearchCharCount) {\n            return [];\n        }\n        return autocompleteRef.current.items\n            .filter(function (item) { return (item.keys.filter(function (key) { return key.includes(searchTerm); }).length > 0); })\n            .splice(0, autocompleteLimit);\n    };\n    var handleChange = function (state) {\n        setEditorState(state);\n    };\n    var handleBeforeInput = function (chars, editorState) {\n        if (chars === \" \" && searchTerm.length) {\n            clearSearch();\n        }\n        else if (autocompleteSelectionStateRef.current) {\n            setSearchTerm(searchTerm + chars);\n        }\n        else {\n            var strategy = findAutocompleteStrategy(chars);\n            if (strategy) {\n                autocompleteRef.current = strategy;\n                updateAutocompletePosition();\n            }\n        }\n        return isMaxLengthHandled(editorState, 1);\n    };\n    var handleEditorFocus = function () {\n        handleFocus();\n        if (isFocusedWithMouse.current === true) {\n            isFocusedWithMouse.current = false;\n            return;\n        }\n        var nextEditorState = draft_js_1.EditorState.forceSelection(editorState, editorState.getSelection());\n        setTimeout(function () { return (setEditorState(draft_js_1.EditorState.moveFocusToEnd(nextEditorState))); }, 0);\n    };\n    var handlePlaceholderFocus = function () {\n        if (isFirstFocus.current === false) {\n            focusEditor();\n            return;\n        }\n        handleFocus();\n        isFirstFocus.current = false;\n    };\n    var handleFocus = function () {\n        focusEditor();\n        if (props.onFocus) {\n            props.onFocus();\n        }\n    };\n    var focusEditor = function () {\n        setFocus(true);\n        setTimeout(function () { var _a; return (_a = editorRef.current) === null || _a === void 0 ? void 0 : _a.focus(); }, 0);\n    };\n    var handleBlur = function () {\n        isFocusedWithMouse.current = false;\n        setFocus(false);\n        if (props.onBlur) {\n            props.onBlur();\n        }\n        if (!state.anchorUrlPopover) {\n            setState(__assign(__assign({}, state), { toolbarPosition: undefined }));\n        }\n    };\n    var handleMouseDown = function () {\n        isFocusedWithMouse.current = true;\n    };\n    var handleClearFormat = function () {\n        if (customStyleMapRef.current === undefined) {\n            return;\n        }\n        var withoutStyles = (0, utils_1.clearInlineStyles)(editorState, customStyleMapRef.current);\n        var selectionInfo = (0, utils_1.getSelectionInfo)(editorState);\n        var newEditorState = draft_js_1.EditorState.push(editorState, withoutStyles, 'change-inline-style');\n        setEditorState(draft_js_1.RichUtils.toggleBlockType(newEditorState, selectionInfo.blockType));\n    };\n    var handleSave = function () {\n        if (props.onSave) {\n            props.onSave(JSON.stringify((0, draft_js_1.convertToRaw)(editorState.getCurrentContent())));\n        }\n    };\n    var handleInsertAtomicBlockSync = function (name, data) {\n        var block = (0, utils_1.atomicBlockExists)(name, props.customControls);\n        if (!block) {\n            return;\n        }\n        var newEditorState = insertAtomicBlock(editorState, block.name.toUpperCase(), data, {\n            selection: editorState.getCurrentContent().getSelectionAfter()\n        });\n        updateStateForPopover(newEditorState);\n    };\n    var handleInsertAtomicBlockAsync = function (name, promise, placeholder) {\n        var selection = insertAsyncAtomicBlockPlaceholder(name, placeholder);\n        var offset = selection.getFocusOffset() + 1;\n        var newSelection = selection.merge({\n            'focusOffset': offset\n        });\n        promise.then(function (response) {\n            var newEditorState = insertAtomicBlock(editorStateRef.current, name, response.data, {\n                selection: newSelection\n            });\n            handleChange(newEditorState);\n        }).catch(function (error) {\n            if (error) {\n                return;\n            }\n            var newContentState = draft_js_1.Modifier.removeRange(editorStateRef.current.getCurrentContent(), newSelection, \"forward\");\n            handleChange(draft_js_1.EditorState.push(editorStateRef.current, newContentState, \"remove-range\"));\n        });\n    };\n    var insertAsyncAtomicBlockPlaceholder = function (name, placeholder) {\n        var placeholderName = placeholder || name + \"...\";\n        var currentContentState = editorStateRef.current.getCurrentContent();\n        var entityKey = currentContentState.createEntity(\"ASYNC_ATOMICBLOCK\", 'IMMUTABLE').getLastCreatedEntityKey();\n        var contentState = draft_js_1.Modifier.insertText(editorStateRef.current.getCurrentContent(), currentContentState.getSelectionAfter(), placeholderName, undefined, entityKey);\n        var selection = currentContentState.getSelectionAfter();\n        var newEditorState = draft_js_1.EditorState.push(editorStateRef.current, contentState, \"insert-characters\");\n        handleChange(newEditorState);\n        return selection;\n    };\n    var handleKeyCommand = function (command, editorState) {\n        var newState = draft_js_1.RichUtils.handleKeyCommand(editorState, command);\n        if (newState) {\n            handleChange(newState);\n            return \"handled\";\n        }\n        else {\n            if (command.includes(\"mui-autocomplete\")) {\n                if (command === \"mui-autocomplete-insert\") {\n                    handleAutocompleteSelected();\n                }\n                if (command === \"mui-autocomplete-end\") {\n                    handleAutocompleteClosed();\n                }\n                return \"handled\";\n            }\n            if (props.keyCommands) {\n                var keyCommand = props.keyCommands.find(function (comm) { return comm.name === command; });\n                if (keyCommand) {\n                    var newState_1 = keyCommand.callback(editorState);\n                    handleChange(newState_1);\n                    return \"handled\";\n                }\n            }\n        }\n        return \"not-handled\";\n    };\n    var handleCustomClick = function (style, id) {\n        if (!props.customControls) {\n            return;\n        }\n        for (var _i = 0, _a = props.customControls; _i < _a.length; _i++) {\n            var control = _a[_i];\n            if (control.name.toUpperCase() === style) {\n                if (control.onClick) {\n                    setTimeout(function () { var _a; return (_a = editorRef.current) === null || _a === void 0 ? void 0 : _a.blur(); }, 0);\n                    var newState = control.onClick(editorState, control.name, document.getElementById(id));\n                    if (newState) {\n                        if (newState.getSelection().isCollapsed()) {\n                            setEditorState(newState);\n                        }\n                        else {\n                            updateStateForPopover(newState);\n                        }\n                    }\n                    else {\n                        if (!editorState.getSelection().isCollapsed()) {\n                            refocus();\n                        }\n                    }\n                }\n                break;\n            }\n        }\n    };\n    var handleUndo = function () {\n        setEditorState(draft_js_1.EditorState.undo(editorState));\n    };\n    var handleRedo = function () {\n        setEditorState(draft_js_1.EditorState.redo(editorState));\n    };\n    var handlePrompt = function (lastState, type, inlineMode) {\n        var selectionInfo = (0, utils_1.getSelectionInfo)(lastState);\n        var contentState = lastState.getCurrentContent();\n        var linkKey = selectionInfo.linkKey;\n        var data = undefined;\n        if (linkKey) {\n            var linkInstance = contentState.getEntity(linkKey);\n            data = linkInstance.getData();\n        }\n        setState({\n            urlData: data,\n            urlKey: linkKey,\n            toolbarPosition: !inlineMode ? undefined : state.toolbarPosition,\n            anchorUrlPopover: !inlineMode ? document.getElementById(editorId + \"-\" + type + \"-control-button\")\n                : document.getElementById(editorId + \"-\" + type + \"-control-button-toolbar\"),\n            urlIsMedia: type === \"media\" ? true : undefined\n        });\n    };\n    var handlePromptForLink = function (inlineMode) {\n        var selection = editorState.getSelection();\n        if (!selection.isCollapsed()) {\n            handlePrompt(editorState, \"link\", inlineMode);\n        }\n    };\n    var handlePromptForMedia = function (inlineMode, newState) {\n        var lastState = newState || editorState;\n        handlePrompt(lastState, \"media\", inlineMode);\n    };\n    var handleConfirmPrompt = function (isMedia) {\n        var args = [];\n        for (var _i = 1; _i < arguments.length; _i++) {\n            args[_i - 1] = arguments[_i];\n        }\n        if (isMedia) {\n            confirmMedia.apply(void 0, args);\n            return;\n        }\n        confirmLink.apply(void 0, args);\n    };\n    var handleToolbarClick = function (style, type, id, inlineMode) {\n        if (type === \"inline\") {\n            return toggleInlineStyle(style);\n        }\n        if (type === \"block\") {\n            return toggleBlockType(style);\n        }\n        switch (style) {\n            case \"UNDO\":\n                handleUndo();\n                break;\n            case \"REDO\":\n                handleRedo();\n                break;\n            case \"LINK\":\n                handlePromptForLink(inlineMode);\n                break;\n            case \"IMAGE\":\n                handlePromptForMedia(inlineMode);\n                break;\n            case \"clear\":\n                handleClearFormat();\n                break;\n            case \"save\":\n                handleSave();\n                break;\n            default:\n                handleCustomClick(style, id);\n        }\n    };\n    var handlePastedText = function (text, _html, editorState) {\n        return isMaxLengthHandled(editorState, text.length);\n    };\n    var handleReturn = function (_e, editorState) {\n        return isMaxLengthHandled(editorState, 1);\n    };\n    var isMaxLengthHandled = function (editorState, nextLength) {\n        var currentLength = editorState.getCurrentContent().getPlainText('').length;\n        return (0, utils_1.isGreaterThan)(currentLength + nextLength, props.maxLength) ? \"handled\" : \"not-handled\";\n    };\n    var toggleMouseUpListener = function (addAfter) {\n        var _a;\n        if (addAfter === void 0) { addAfter = false; }\n        var editor = (_a = editorRef.current) === null || _a === void 0 ? void 0 : _a.editor;\n        if (!editor) {\n            return;\n        }\n        editor.removeEventListener(\"mouseup\", handleMouseUp);\n        if (addAfter) {\n            editor.addEventListener(\"mouseup\", handleMouseUp);\n        }\n    };\n    var removeLink = function () {\n        var selection = editorState.getSelection();\n        setEditorState(draft_js_1.RichUtils.toggleLink(editorState, selection, null));\n    };\n    var confirmLink = function (url) {\n        var urlKey = state.urlKey;\n        if (!url) {\n            if (urlKey) {\n                removeLink();\n            }\n            dismissPopover();\n            return;\n        }\n        var contentState = editorState.getCurrentContent();\n        var replaceEditorState = editorState;\n        var data = {\n            url: url,\n            className: classes.anchorLink\n        };\n        if (urlKey) {\n            contentState.replaceEntityData(urlKey, data);\n            replaceEditorState = draft_js_1.EditorState.push(editorState, contentState, \"apply-entity\");\n        }\n        else {\n            var contentStateWithEntity = contentState.createEntity('LINK', 'MUTABLE', data);\n            var entityKey = contentStateWithEntity.getLastCreatedEntityKey();\n            var newEditorState = draft_js_1.EditorState.set(editorState, { currentContent: contentStateWithEntity });\n            replaceEditorState = draft_js_1.RichUtils.toggleLink(newEditorState, newEditorState.getSelection(), entityKey);\n        }\n        updateStateForPopover(replaceEditorState);\n    };\n    var removeMedia = function () {\n        var blockKey = editorState.getSelection().getStartKey();\n        var contentState = editorState.getCurrentContent();\n        var mediaBlock = contentState.getBlockForKey(blockKey);\n        var newContentState = (0, utils_1.removeBlockFromMap)(editorState, mediaBlock);\n        var newEditorState = draft_js_1.EditorState.push(editorState, newContentState, \"remove-range\");\n        setEditorState(newEditorState);\n    };\n    var confirmMedia = function (url, width, height, alignment, type) {\n        var urlKey = state.urlKey;\n        if (!url) {\n            if (urlKey) {\n                removeMedia();\n            }\n            dismissPopover();\n            return;\n        }\n        var contentState = editorState.getCurrentContent();\n        var data = {\n            url: url,\n            width: width,\n            height: height,\n            alignment: alignment,\n            type: type\n        };\n        if (urlKey) {\n            contentState.replaceEntityData(urlKey, data);\n            var newEditorState = draft_js_1.EditorState.push(editorState, contentState, \"apply-entity\");\n            updateStateForPopover(draft_js_1.EditorState.forceSelection(newEditorState, newEditorState.getCurrentContent().getSelectionAfter()));\n        }\n        else {\n            var newEditorState = insertAtomicBlock(editorState, \"IMAGE\", data);\n            updateStateForPopover(draft_js_1.EditorState.forceSelection(newEditorState, newEditorState.getCurrentContent().getSelectionAfter()));\n        }\n        setFocusMediaKey(\"\");\n    };\n    var updateStateForPopover = function (editorState) {\n        setEditorState(editorState);\n        dismissPopover();\n    };\n    var dismissPopover = function () {\n        refocus();\n        setState(__assign(__assign({}, state), { anchorUrlPopover: undefined, urlKey: undefined, urlIsMedia: undefined, urlData: undefined }));\n    };\n    var refocus = function () {\n        setTimeout(function () { var _a; return (_a = editorRef.current) === null || _a === void 0 ? void 0 : _a.blur(); }, 0);\n        setTimeout(function () { var _a; return (_a = editorRef.current) === null || _a === void 0 ? void 0 : _a.focus(); }, 1);\n    };\n    var toggleBlockType = function (blockType) {\n        setEditorState(draft_js_1.RichUtils.toggleBlockType(editorState, blockType));\n    };\n    var toggleInlineStyle = function (inlineStyle) {\n        setEditorState(draft_js_1.RichUtils.toggleInlineStyle(editorState, inlineStyle));\n    };\n    var focusMedia = function (block) {\n        var newSeletion = draft_js_1.SelectionState.createEmpty(block.getKey());\n        var newEditorState = draft_js_1.EditorState.forceSelection(editorStateRef.current, newSeletion);\n        editorStateRef.current = newEditorState;\n        setFocusMediaKey(block.getKey());\n        setEditorState(newEditorState);\n        handlePromptForMedia(false, newEditorState);\n    };\n    var getStyleMap = function () {\n        if (customStyleMapRef.current === undefined) {\n            setupStyleMap();\n        }\n        return customStyleMapRef.current;\n    };\n    var setupStyleMap = function () {\n        var _a;\n        var customStyleMap = JSON.parse(JSON.stringify(styleRenderMap));\n        (_a = props.customControls) === null || _a === void 0 ? void 0 : _a.filter(function (control) { return control.type === \"inline\" && control.inlineStyle; }).forEach(function (control) {\n            customStyleMap[control.name.toUpperCase()] = control.inlineStyle;\n        });\n        customStyleMapRef.current = customStyleMap;\n    };\n    var getBlockMap = function () {\n        if (customBlockMapRef.current === undefined) {\n            setupBlockMap();\n        }\n        return customBlockMapRef.current;\n    };\n    var setupBlockMap = function () {\n        var _a;\n        var customBlockMap = {};\n        (_a = props.customControls) === null || _a === void 0 ? void 0 : _a.filter(function (control) { return control.type === \"block\" && control.blockWrapper; }).forEach(function (control) {\n            customBlockMap[control.name.toUpperCase()] = {\n                element: \"div\",\n                wrapper: control.blockWrapper\n            };\n        });\n        customBlockMapRef.current = draft_js_1.DefaultDraftBlockRenderMap.merge(blockRenderMap, immutable_1.default.Map(customBlockMap));\n    };\n    var blockRenderer = function (contentBlock) {\n        var blockType = contentBlock.getType();\n        if (blockType === 'atomic') {\n            var contentState = editorState.getCurrentContent();\n            var entity = contentBlock.getEntityAt(0);\n            if (entity) {\n                var type = contentState.getEntity(entity).getType();\n                if (type === \"IMAGE\") {\n                    return {\n                        component: Media_1.default,\n                        editable: false,\n                        props: {\n                            onClick: focusMedia,\n                            readOnly: props.readOnly,\n                            focusKey: focusMediaKey\n                        }\n                    };\n                }\n                else {\n                    var block = (0, utils_1.atomicBlockExists)(type.toLowerCase(), props.customControls);\n                    if (block) {\n                        return {\n                            component: block.atomicComponent,\n                            editable: false,\n                            props: contentState.getEntity(contentBlock.getEntityAt(0)).getData()\n                        };\n                    }\n                }\n            }\n        }\n        return null;\n    };\n    var styleRenderer = function (style) {\n        var customStyleMap = getStyleMap();\n        var styleNames = style.toJS();\n        return styleNames.reduce(function (styles, styleName) {\n            styles = customStyleMap[styleName];\n            return styles;\n        }, {});\n    };\n    var insertAtomicBlock = function (editorState, type, data, options) {\n        var contentState = editorState.getCurrentContent();\n        var contentStateWithEntity = contentState.createEntity(type, 'IMMUTABLE', data);\n        var entityKey = contentStateWithEntity.getLastCreatedEntityKey();\n        var newEditorStateRaw = draft_js_1.EditorState.set(editorState, __assign({ currentContent: contentStateWithEntity }, options));\n        return draft_js_1.AtomicBlockUtils.insertAtomicBlock(newEditorStateRaw, entityKey, ' ');\n    };\n    var getAutocompleteKeyEvent = function (keyboardEvent) {\n        var itemsLength = getAutocompleteItems().length;\n        var limit = autocompleteLimit > itemsLength ? itemsLength : autocompleteLimit;\n        switch (keyboardEvent.key) {\n            case \"ArrowDown\":\n                if ((selectedIndex === 0 && itemsLength === 1) || (selectedIndex + 1 === limit)) {\n                    setSelectedIndex(0);\n                }\n                else {\n                    setSelectedIndex(selectedIndex + 1 < limit ? selectedIndex + 1 : selectedIndex);\n                }\n                return \"mui-autocomplete-navigate\";\n            case \"ArrowUp\":\n                if (selectedIndex) {\n                    setSelectedIndex(selectedIndex - 1);\n                }\n                else {\n                    setSelectedIndex(limit - 1);\n                }\n                return \"mui-autocomplete-navigate\";\n            case \"Enter\":\n                return \"mui-autocomplete-insert\";\n            case \"Escape\":\n                return \"mui-autocomplete-end\";\n            default:\n                return null;\n        }\n    };\n    var updateSearchTermForKeyBinding = function (keyBinding) {\n        var text = editorStateRef.current.getCurrentContent().getLastBlock().getText();\n        if (keyBinding === \"backspace\"\n            && autocompleteRef.current\n            && text.substr(text.length - 1) === autocompleteRef.current.triggerChar) {\n            clearSearch();\n        }\n        else if (autocompletePositionRef.current\n            && keyBinding === \"backspace\"\n            && searchTerm.length) {\n            setSearchTerm(searchTerm.substr(0, searchTerm.length - 1));\n        }\n        else if (!autocompletePositionRef.current &&\n            (keyBinding === \"backspace\"\n                || keyBinding === \"split-block\")) {\n            clearSearch();\n        }\n    };\n    var keyBindingFn = function (e) {\n        if (hasCommandModifier(e) && props.keyCommands) {\n            var comm = props.keyCommands.find(function (comm) { return comm.key === e.keyCode; });\n            if (comm) {\n                return comm.name;\n            }\n        }\n        if (searchTerm) {\n            var autocompleteEvent = getAutocompleteKeyEvent(e);\n            if (autocompleteEvent) {\n                return autocompleteEvent;\n            }\n        }\n        var keyBinding = (0, draft_js_1.getDefaultKeyBinding)(e);\n        updateSearchTermForKeyBinding(keyBinding);\n        return keyBinding;\n    };\n    var renderToolbar = props.toolbar === undefined || props.toolbar;\n    var inlineToolbarControls = props.inlineToolbarControls || defaultInlineToolbarControls;\n    var editable = props.readOnly === undefined || !props.readOnly;\n    var className = \"\";\n    var placeholder = null;\n    if (!focus) {\n        var contentState = editorState.getCurrentContent();\n        if (!contentState.hasText()) {\n            placeholder = (react_1.default.createElement(\"div\", { className: (0, classnames_1.default)(classes.editorContainer, classes.placeHolder, (_a = {},\n                    _a[classes.error] = props.error,\n                    _a)), tabIndex: 0, onFocus: handlePlaceholderFocus }, props.label || \"\"));\n            className = classes.hidePlaceholder;\n        }\n    }\n    return (react_1.default.createElement(\"div\", { id: editorId + \"-root\", className: classes.root },\n        react_1.default.createElement(\"div\", { id: editorId + \"-container\", className: (0, classnames_1.default)(classes.container, (_b = {},\n                _b[classes.inheritFontSize] = props.inheritFontSize,\n                _b)) },\n            props.autocomplete && autocompletePositionRef.current ?\n                react_1.default.createElement(Autocomplete_1.default, { items: getAutocompleteItems(), top: autocompletePositionRef.current.top, left: autocompletePositionRef.current.left, onClick: handleAutocompleteSelected, selectedIndex: selectedIndex })\n                : null,\n            props.inlineToolbar && editable && state.toolbarPosition ?\n                react_1.default.createElement(material_1.Paper, { className: classes.inlineToolbar, style: {\n                        top: state.toolbarPosition.top,\n                        left: state.toolbarPosition.left\n                    } },\n                    react_1.default.createElement(Toolbar_1.default, { id: editorId, editorState: editorState, onClick: handleToolbarClick, controls: inlineToolbarControls, customControls: customControls, inlineMode: true, isActive: true }))\n                : null,\n            renderToolbar ?\n                react_1.default.createElement(Toolbar_1.default, { id: editorId, editorState: editorState, onClick: handleToolbarClick, controls: controls, customControls: customControls, className: classes.toolbar, disabled: !editable, size: props.toolbarButtonSize, isActive: focus })\n                : null,\n            placeholder,\n            react_1.default.createElement(\"div\", { id: editorId + \"-editor\", className: classes.editor },\n                react_1.default.createElement(\"div\", { id: editorId + \"-editor-container\", className: (0, classnames_1.default)(className, classes.editorContainer, (_c = {},\n                        _c[classes.editorReadOnly] = !editable,\n                        _c[classes.error] = props.error,\n                        _c)), onMouseDown: handleMouseDown, onBlur: handleBlur },\n                    react_1.default.createElement(draft_js_1.Editor, __assign({ blockRenderMap: getBlockMap(), blockRendererFn: blockRenderer, customStyleFn: styleRenderer, editorState: editorState, onChange: handleChange, onFocus: handleEditorFocus, readOnly: props.readOnly, handleKeyCommand: handleKeyCommand, handleBeforeInput: handleBeforeInput, handlePastedText: handlePastedText, handleReturn: handleReturn, keyBindingFn: keyBindingFn, ref: editorRef }, props.draftEditorProps)))),\n            state.anchorUrlPopover ?\n                react_1.default.createElement(UrlPopover_1.default, { data: state.urlData, anchor: state.anchorUrlPopover, onConfirm: handleConfirmPrompt, isMedia: state.urlIsMedia })\n                : null)));\n};\nexports.default = (0, styles_1.withStyles)(styles, { withTheme: true, name: \"MUIRichTextEditor\" })((0, react_1.forwardRef)(MUIRichTextEditor));\n//# sourceMappingURL=MUIRichTextEditor.js.map"]},"metadata":{},"sourceType":"script"}